<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>STAT 125 - Measuring disease</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">STAT 125</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./schedule.html" rel="" target="">
 <span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./syllabus.html" rel="" target="">
 <span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-activities" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Activities</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-activities">    
        <li>
    <a class="dropdown-item" href="./01-introductions.html" rel="" target="">
 <span class="dropdown-text">Welcome to the course!</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./02-measuring-disease.html" rel="" target="">
 <span class="dropdown-text">Measuring disease</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./03-mortality-standardization.html" rel="" target="">
 <span class="dropdown-text">Measuring mortality, standardization</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./04-life-exp.html" rel="" target="">
 <span class="dropdown-text">Life expectancy</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./mini-project1.html" rel="" target="">
 <span class="dropdown-text">Mini-project 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./05-cohort.html" rel="" target="">
 <span class="dropdown-text">Cohort studies</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./06-case-control.html" rel="" target="">
 <span class="dropdown-text">Case-control studies</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./07-confounding-causation.html" rel="" target="">
 <span class="dropdown-text">Confounding and causation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./mini-project2.html" rel="" target="">
 <span class="dropdown-text">Mini-project 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./pause_reflect.html" rel="" target="">
 <span class="dropdown-text">Pause and reflect</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-content-conversations" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Content Conversations</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-content-conversations">    
        <li>
    <a class="dropdown-item" href="./content_conversation1.html" rel="" target="">
 <span class="dropdown-text">Content Conversation 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./content_conversation2.html" rel="" target="">
 <span class="dropdown-text">Content Conversation 2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./project.html" rel="" target="">
 <span class="menu-text">Project</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#learning-goals" id="toc-learning-goals" class="nav-link active" data-scroll-target="#learning-goals">Learning goals</a></li>
  <li><a href="#review-of-video-material" id="toc-review-of-video-material" class="nav-link" data-scroll-target="#review-of-video-material">Review of video material</a>
  <ul class="collapse">
  <li><a href="#burden-vs.-risk" id="toc-burden-vs.-risk" class="nav-link" data-scroll-target="#burden-vs.-risk">Burden vs.&nbsp;risk</a></li>
  <li><a href="#being-careful-about-denominators" id="toc-being-careful-about-denominators" class="nav-link" data-scroll-target="#being-careful-about-denominators">Being careful about denominators</a></li>
  <li><a href="#prevalence" id="toc-prevalence" class="nav-link" data-scroll-target="#prevalence">Prevalence</a></li>
  <li><a href="#cumulative-incidence" id="toc-cumulative-incidence" class="nav-link" data-scroll-target="#cumulative-incidence">Cumulative incidence</a></li>
  <li><a href="#incidence-rate" id="toc-incidence-rate" class="nav-link" data-scroll-target="#incidence-rate">Incidence rate</a></li>
  <li><a href="#relationship-between-prevalence-and-incidence" id="toc-relationship-between-prevalence-and-incidence" class="nav-link" data-scroll-target="#relationship-between-prevalence-and-incidence">Relationship between prevalence and incidence</a></li>
  </ul></li>
  <li><a href="#activity" id="toc-activity" class="nav-link" data-scroll-target="#activity">Activity</a></li>
  <li><a href="#broader-application-of-these-ideas" id="toc-broader-application-of-these-ideas" class="nav-link" data-scroll-target="#broader-application-of-these-ideas">Broader application of these ideas</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Measuring disease</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="learning-goals" class="level1">
<h1>Learning goals</h1>
<p>After this lesson, you should be able to:</p>
<ul>
<li>Describe the difference between prevalence and incidence in terms of the concepts of disease risk and disease burden.</li>
<li>Evaluate whether information on prevalence or incidence is more relevant to a particular public health question.</li>
<li>Compute prevalence, cumulative incidence, and incidence rate from appropriate data.</li>
<li>Describe how the prevalence of a disease is affected by incidence and typical duration of disease.</li>
</ul>
<p><br><br><br><br></p>
</section>
<section id="review-of-video-material" class="level1">
<h1>Review of video material</h1>
<section id="burden-vs.-risk" class="level2">
<h2 class="anchored" data-anchor-id="burden-vs.-risk">Burden vs.&nbsp;risk</h2>
<p>Central question: how “common” is a given disease?</p>
<p>Thinking about the word “common” involves contrasting the notions of disease <strong>risk</strong> and <strong>burden</strong>.</p>
<ul>
<li><strong>Risk:</strong> How likely is it for an individual to develop this disease within a given time span?
<ul>
<li>Concerned with <em>new</em> disease cases</li>
<li>Measured with <strong>incidence</strong> (cumulative incidence and incidence rate)</li>
</ul></li>
<li><strong>Burden:</strong> How much of the population is living with the disease now?
<ul>
<li>Concerned with <em>existing</em> disease cases</li>
<li>Measured with <strong>prevalence</strong></li>
</ul></li>
</ul>
</section>
<section id="being-careful-about-denominators" class="level2">
<h2 class="anchored" data-anchor-id="being-careful-about-denominators">Being careful about denominators</h2>
<p>With prevalence and incidence measures, we need to be very careful about denominators. Everyone represented by the denominator must be capable of being counted in the numerator–otherwise, the measure gives a distorted view of how “common” the disease is.</p>
</section>
<section id="prevalence" class="level2">
<h2 class="anchored" data-anchor-id="prevalence">Prevalence</h2>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Prevalence</mtext><mo>=</mo><mfrac><mtext mathvariant="normal"># cases at a given time</mtext><mtext mathvariant="normal"># who COULD be a case at a given time</mtext></mfrac></mrow><annotation encoding="application/x-tex">
\text{Prevalence} = \frac{\text{# cases at a given time}}{\text{# who COULD be a case at a given time}}
</annotation></semantics></math></p>
<div class="callout callout-style-default callout-tip callout-titled" title="Example">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>In a recent survey of 1000 people, 11 report having asthma. The estimated prevalence of asthma would be 11/1000 = 0.011 or 1.1%.</p>
<p><strong>Interpretation:</strong> An estimated 1.1% of people are living with asthma right now.</p>
</div>
</div>
<p><strong>Question:</strong> Suppose we are trying to estimate the prevalence of COVID at Macalester on January 1, 2024. Do you think that “total # of employees hired and students enrolled on Jan 1” is a good denominator? Explain.</p>
<details>
<summary>
Response
</summary>
<p>If the goal of estimating the COVID prevalence on that date is to inform immediate campus policy regarding public health measures, the most useful denominator should probably consist of people who are actually using campus. Students who will be on vacation for a while and students who are studying abroad should not be counted in the denominator. Similarly for employees who do not work during January.</p>
</details>
</section>
<section id="cumulative-incidence" class="level2">
<h2 class="anchored" data-anchor-id="cumulative-incidence">Cumulative incidence</h2>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Cumulative incidence</mtext><mo>=</mo><mfrac><mtext mathvariant="normal"># NEW cases that develop over a time span</mtext><mtext mathvariant="normal"># who COULD be a case in that time span</mtext></mfrac></mrow><annotation encoding="application/x-tex">
\text{Cumulative incidence} = \frac{\text{# NEW cases that develop over a time span}}{\text{# who COULD be a case in that time span}}
</annotation></semantics></math></p>
<div class="callout callout-style-default callout-tip callout-titled" title="Example">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>A study followed 1000 children fully for the first 5 years of their lives. 12 develop asthma within that time. The estimated cumulative incidence would be 12/1000 = 0.012 or 1.2%.</p>
<p><strong>Interpretation:</strong> We estimate that 1.2% of children will develop asthma in the first 5 years of life.</p>
</div>
</div>
</section>
<section id="incidence-rate" class="level2">
<h2 class="anchored" data-anchor-id="incidence-rate">Incidence rate</h2>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Incidence rate</mtext><mo>=</mo><mfrac><mtext mathvariant="normal"># NEW cases that develop over a time span</mtext><mtext mathvariant="normal">Total person-years at risk</mtext></mfrac></mrow><annotation encoding="application/x-tex">
\text{Incidence rate} = \frac{\text{# NEW cases that develop over a time span}}{\text{Total person-years at risk}}
</annotation></semantics></math></p>
<ul>
<li>If individuals in a study are followed up for different lengths of time, it is better to use the incidence rate rather than cumulative incidence so that the total time that individuals were followed up is more accurately represented.
<ul>
<li>Why? A study follows 1000 people for 5 years, but most individuals stop participating in the study by year 2. We’re really not observing the 1000 people for the full 5 years. There’s quite a lot of time in those 5 years that we’re not observing people who may develop disease. Using cumulative incidence would <strong>understate</strong> the risk of the disease.</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Example">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>A study followed 1000 children for the first 5 years of their lives for a total of 2500 person-years of follow up. 12 develop asthma within that time. The estimated incidence rate would be 12/2500 = 0.0048 cases per person-year.</p>
<p><strong>Interpretation:</strong> We estimate that 0.0048 new cases of asthma in children per person-year. Because 1/0.0048 = 208.33, we could also phrase this as 1 case per 208.33 person-years.</p>
</div>
</div>
<p><br></p>
</section>
<section id="relationship-between-prevalence-and-incidence" class="level2">
<h2 class="anchored" data-anchor-id="relationship-between-prevalence-and-incidence">Relationship between prevalence and incidence</h2>
<p>For conditions that are not very common (low prevalence):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Prevalence</mtext><mo>≈</mo><mtext mathvariant="normal">Incidence</mtext><mo>×</mo><mtext mathvariant="normal">Mean disease duration</mtext></mrow><annotation encoding="application/x-tex">
\text{Prevalence} \approx \text{Incidence} \times \text{Mean disease duration}
</annotation></semantics></math></p>
<p>Why is this approximate relationship important?</p>
<ul>
<li>Low prevalence doesn’t necessarily mean low risk.</li>
<li>Example: Males have a <a href="https://www.cdc.gov/cancer/uscs/about/data-briefs/no9-melanoma-incidence-mortality-UnitedStates-2012-2016.htm">higher melanoma incidence</a>, but males survive a shorter amount of time (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1570554/">here</a> and <a href="https://pubmed.ncbi.nlm.nih.gov/21150923/">here</a>) with it than females. Females might have a higher <em>prevalence</em> of melanoma than males even though their <em>risk</em> is lower.</li>
</ul>
<p><br><br><br><br></p>
</section>
</section>
<section id="activity" class="level1">
<h1>Activity</h1>
<p>Navigate to <a href="https://moodle.macalester.edu/mod/folder/view.php?id=82197">Moodle</a>, and open the PDF titled <code>02_measuring_disease_activity</code>.</p>
<p><br><br><br><br></p>
</section>
<section id="broader-application-of-these-ideas" class="level1">
<h1>Broader application of these ideas</h1>
<p>I’m currently reading <em>Attached</em> by Amir Levine and Rachel Heller. This is a book about adult attachment theory in romantic relationships, and while it seems to be far removed from epidemiology, I found myself thinking about ideas from class this week when reading the early chapters.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://m.media-amazon.com/images/I/71kpAWQz7EL._AC_UF1000,1000_QL80_.jpg" class="img-fluid figure-img" width="300"></p>
</figure>
</div>
<blockquote class="blockquote">
<p>Adult attachment designates three main “attachment styles” or manners in which people perceive and respond to intimacy in romantic relationships, which parallel those found in children: Secure, Anxious, and Avoidant. Basically, <em>secure</em> people fell comfortable with intimacy and are usually warm and loving; <em>anxious</em> people crave intimacy, are often preoccupied with their relationships, and tend to worry about their partner’s ability to love them back; and <em>avoidant</em> people equate intimacy with a loss of independence and constantly seek to minimize closeness. … All people in our society, whether they have just started dating someone or have been married for forty years, fall into one of these categories, or, more rarely, into a combination of the latter two (anxious and avoidant). Just over 50% are secure, around 20% are anxious, 25% are avoidant, and the remaining 3-5% fall into the fourth, less common category (combination of anvious and avoidant). <em>Attached</em>, pages 8-9</p>
</blockquote>
<p>These percentages are definitely prevalences, but I wondered about them because another part of the book discusses how people can change their attachment style. I wondered about what population these percentages are actually a snapshot of and whether (through this book!?) those percentages might likely change.</p>
<p>My partner also floated the claim that the dating pool might actually be enriched for people with avoidant attachment styles. (He claimed that whatever the prevalence of the avoidant style in the general population, they form a greater percentage in the pool of people who are currently dating.)</p>
<ul>
<li>This made me think about our bathtub analogy for the relationship between prevalence, incidence, and average disease duration.</li>
<li>We can think of the water level as the dating pool. Entry into that pool (incidence) might be due to avoidant-attachers leaving their current relationships (through avoidance) and re-entering the dating pool.</li>
<li>Drainage from the pool might be enriched for secure-attachers who find relationships and stick with them, thus leaving the dating pool for a long time (or forever).</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© Leslie Myint, 2024<br> All content licensed under <img src="https://static.thenounproject.com/png/70967-200.png" height="20"> (<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>)</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Site built with <a href="https://quarto.org/">Quarto</a></div>
  </div>
</footer>



</body></html>